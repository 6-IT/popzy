Modal.elements=[];function Modal(options){this.opt=Object.assign({closeMethods:["button","overlay","escape"],destroyOnClose:true,cssClass:[],footer:false},options);this.template=document.querySelector(`#${this.opt.teamplateId}`);if(!this.template){console.error("Loi");return}this._allowButtonClose=this.opt.closeMethods.includes("button");this._allowBackdropClose=this.opt.closeMethods.includes("overlay");this._allowEscapeClose=this.opt.closeMethods.includes("escape");this._footerButtons=[];this._handleEscapeKey=this._handleEscapeKey.bind(this)}Modal.prototype.build=function(){const content=this.template.content.cloneNode(true);this._backdrop=document.createElement("div");this._backdrop.className="modal-backdrop";const container=document.createElement("div");container.className="modal-container";this.opt.cssClass.forEach((el=>{if(typeof el==="string")container.classList.add(el)}));if(this._allowButtonClose){const closeModal=this._createButton("&times","modal-close",(()=>this.close()));container.append(closeModal)}const contentModal=document.createElement("div");contentModal.className="modal-content";contentModal.append(content);container.append(contentModal);if(this.opt.footer){this._footerModal=document.createElement("div");this._footerModal.className="footer-modal";this._renderFooterContent();this._renderFooterButtons();container.append(this._footerModal)}this._backdrop.append(container);document.body.append(this._backdrop)};Modal.prototype.open=function(){Modal.elements.push(this);if(!this._backdrop){this.build()}setTimeout((()=>{this._backdrop.classList.add("show")}),0);if(this._allowBackdropClose){this._backdrop.onclick=e=>{if(e.target===this._backdrop)this.close()}}if(this._allowEscapeClose){document.addEventListener("keydown",this._handleEscapeKey)}document.body.classList.add("no-scroll");document.body.style.paddingRight=this._getWidthSrollBar()+"px";this._ontransitionend(this.opt.onOpen);return this._backdrop};Modal.prototype._ontransitionend=function(callback){this._backdrop.ontransitionend=e=>{if(e.propertyName!=="transform")return;if(typeof callback==="function")callback()}};Modal.prototype._handleEscapeKey=function(e){const lastModal=Modal.elements[Modal.elements.length-1];if(e.key==="Escape"&&this===lastModal)this.close()};Modal.prototype.setFooterModdal=function(html){this._footerContent=html;this._renderFooterContent()};Modal.prototype._createButton=function(title,cssClass,callback){const button=document.createElement("button");button.innerHTML=title;button.className=cssClass;button.onclick=callback;return button};Modal.prototype.addButtonFooter=function(title,cssClass,callback){const button=this._createButton(title,cssClass,callback);this._footerButtons.push(button);this._renderFooterButtons()};Modal.prototype._renderFooterContent=function(){if(this._footerModal&&this._footerContent){this._footerModal.innerHTML=this._footerContent}};Modal.prototype._renderFooterButtons=function(){if(this._footerModal){this._footerButtons.forEach((btn=>{this._footerModal.append(btn)}))}};Modal.prototype.close=function(destroy=this.opt.destroyOnClose){Modal.elements.pop();this._backdrop.classList.remove("show");if(this._allowEscapeClose){document.removeEventListener("keydown",this._handleEscapeKey)}this._ontransitionend((()=>{if(destroy&&this._backdrop){this._backdrop.remove();this._backdrop=null}if(!Modal.elements.length){document.body.classList.remove("no-scroll");document.body.style.paddingRight=""}if(typeof onClose==="function")this.opt.onClose()}))};Modal.prototype.destroy=function(){this.close(true)};Modal.prototype._getWidthSrollBar=function(){if(this._widthScroll)return this._widthScroll;const div=document.createElement("div");Object.assign(div.style,{overflow:"scroll",position:"absolute",top:"9999px"});document.body.append(div);this._widthScroll=div.offsetWidth-div.clientWidth;document.body.removeChild(div);return this._widthScroll};